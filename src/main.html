<!-- main.html -->
<!DOCTYPE html>
<html lang="ko">
<head>
    <title>Main Page - Campus Reservation</title>
    <link rel="stylesheet" href="main.css">
</head>
<body>
    <header>
        <h1>Campus Reservation</h1>
        <button class="menu-button">☰</button>
    </header>

    <!-- 사이드 메뉴 -->
    <div class="side-menu">
        <button class="close-menu">&times;</button>
        <div class="user-info">
            <p><span id="currentUser"></span>님 안녕하세요!</p>
        </div>
        <ul>
            <li><a href="my_reservation.html">예약 현황</a></li>
            <li><a href="index.html" onclick="handleLogout(); return false;">로그아웃</a></li>
        </ul>
    </div>

    <!-- 건물 사이드바 -->
    <div class="building-sidebar">
        <button class="close-building-sidebar">&times;</button>
        <div class="building-info">
            <h2 id="selected-building-name"></h2>
        </div>
        <div class="reservation-buttons">
            <button class="btn-primary" onclick="handleSpaceReservation()">공간 예약</button>
            <button class="btn-primary" onclick="handleSeatReservation()">좌석 예약</button>
        </div>
    </div>

    <section class="main-page">
        <div class="content">
            <h2>캠퍼스 지도</h2>
            <div class="campus-buttons">
                <button class="campus-btn" onclick="switchCampus('seoul')">서울캠퍼스(자연)</button>
                <button class="campus-btn active" onclick="switchCampus('sejong')">세종캠퍼스</button>
                <button class="campus-btn" onclick="switchCampus('shared')">세종공동캠퍼스</button>
            </div>
            <br>
            <div class="map-container">
                <div id="map">
                    <!-- 세종캠퍼스 맵 -->
                    <svg id="sejong-map" viewBox="0 0 1600 900" class="map-image">
                        <!-- 건물 및 도로 SVG 요소들 -->
                        <rect class="building" x="10" y="500" width="150" height="60" onclick="showBuilding(event, '가속기 ICT 융합관')" />
                        <text x="85" y="530" class="building-label">가속기 ICT 융합관</text>
                        
                        <rect class="building" x="175" y="500" width="150" height="60" onclick="showBuilding(event, '산학협력관')" />
                        <text x="250" y="530" class="building-label">산학협력관</text>
                        
                        <rect class="building" x="340" y="500" width="170" height="60" onclick="showBuilding(event, '농심국제관')" />
                        <text x="425" y="530" class="building-label">농심국제관</text>

                        <text x="895" y="660" class="building-label">정문</text>

                        <!-- 도로 -->
                        <rect class="road" x="0" y="430" width="1200" height="30"/>
                        <rect class="road" x="530" y="200" width="10" height="400"/>
                        <rect class="road" x="880" y="430" width="40" height="210"/>

                        <!-- 추가 건물 -->
                        <rect class="building" x="0" y="330" width="70" height="90" onclick="showBuilding(event, '약학 대학')" />
                        <text x="35" y="380" class="building-label">약학 대학</text>
                        
                        <rect class="building" x="100" y="330" width="150" height="70" onclick="showBuilding(event, '과학기술 1관')" />
                        <text x="175" y="370" class="building-label">과학기술 1관</text>

                        <rect class="building" x="550" y="330" width="170" height="50" onclick="showBuilding(event, '학술 정보원')" />
                        <text x="635" y="360" class="building-label">학술 정보원</text>

                        <rect class="road" x="110" y="250" width="1300" height="40"/>

                        <rect class="building" x="570" y="180" width="130" height="50" onclick="showBuilding(event, '과학기술 2관')" />
                        <text x="635" y="210" class="building-label">과학기술 2관</text>
                        
                        <rect class="building" x="910" y="160" width="170" height="70" onclick="showBuilding(event, '석원 경상관')" />
                        <text x="1000" y="200" class="building-label">석원 경상관</text>
                        
                        <rect class="building" x="1100" y="180" width="130" height="50" onclick="showBuilding(event, '문스대')" />
                        <text x="1165" y="210" class="building-label">문스대</text>
                        
                        <rect class="building" x="1250" y="180" width="50" height="50" onclick="showBuilding(event, '체육관')" />
                        <text x="1275" y="210" class="building-label">체육관</text>

                        <rect class="building" x="720" y="110" width="150" height="50" onclick="showBuilding(event, '공공정책관')" />
                        <text x="795" y="140" class="building-label">공공정책관</text>
                    </svg>

                    <!-- 서울캠퍼스 맵 (숨김) -->
                    <svg id="seoul-map" viewBox="0 0 1300 700" class="map-image" style="display: none;">
                        <!--도로-->
                        <rect class="road" x="50", y="130", width="1200", height="30" />
                        <rect class="road" x="610", y="130", width="100", height="300" />
                        <rect class="road" x="630", y="400", width="50", height="330" />
                        <rect class="road" x="630", y="400", width="80", height="110" />

                        <rect class="road" x="50", y="130", width="30", height="280" />
                        <rect class="road" x="180", y="130", width="80", height="190" />
                        <rect class="road" x="180", y="310", width="10", height="100" />

                        <rect class="road" x="180", y="420", width="500", height="30" />
                        <rect class="road" x="210", y="420", width="30", height="210" />
                        <rect class="road" x="340", y="420", width="50", height="210" />
                        <rect class="road" x="510", y="420", width="30", height="210" />
                        <rect class="road" x="50", y="400", width="140", height="20" />
                        <rect class="road" x="240", y="600", width="400", height="30" />


                        <rect class="road" x="670", y="240", width="420", height="20" />
                        <rect class="road" x="670", y="500", width="300", height="20" />
                        <rect class="road" x="670", y="640", width="410", height="30" />
                        <rect class="road" x="960", y="480", width="140", height="30" />
                        <rect class="road" x="1080", y="550", width="170", height="40" />

                        <rect class="road" x="960", y="500", width="30", height="150" />
                        <rect class="road" x="1080", y="130", width="40", height="540" />
                        <rect class="road" x="1250", y="130", width="40", height="600" />
                        
                        
                        <!--상단-->
                        <rect class="building" x="260", y="50", width="200", height="70" onclick="showBuilding(event, '기초과학관')" />
                        <text x="340" y="85" class="building-label2">기초과학관</text>
                        <rect class="building" x="530", y="10", width="250", height="100" onclick="showBuilding(event, '이산이학관')" />
                        <text x="610" y="60" class="building-label2">이산이학관</text>
                        <rect class="building" x="850", y="50", width="200", height="70" onclick="showBuilding(event, '생명과학관')" />
                        <text x="930" y="85" class="building-label2">생명과학관</text>

                        <!--왼쪽-->
                        <rect class="building" x="90", y="180", width="70", height="200" onclick="showBuilding(event, '산학관')" />
                        <text x="122" y="210" class="building-label2">산학관</text>
                        <rect class="building" x="210", y="330", width="320", height="80" onclick="showBuilding(event, '공학관')" />
                        <text x="380" y="380" class="building-label2">공학관</text>
                        <rect class="building" x="250", y="470", width="70", height="100" onclick="showBuilding(event, '전파공학관')" />
                        <text x="275" y="500" class="building-label2">전파</text>
                        <text x="285" y="525" class="building-label2">공학관</text>
                        <rect class="building" x="420", y="460", width="80", height="130" onclick="showBuilding(event, '창의관')" />
                        <text x="460" y="525" class="building-label2">창의관</text>
                        <rect class="building" x="555", y="470", width="70", height="100" onclick="showBuilding(event, '공학관(별관)')" />
                        <text x="590" y="525" class="building-label2">공학관</text>
                        <text x="590" y="550" class="building-label2">(별관)</text>
                        <rect class="building" x="270", y="640", width="100", height="50" onclick="showBuilding(event, '실내체육관')" />
                        <text x="320" y="675" class="building-label2">실내체육관</text>
                        
                        <!--오른쪽-->
                        <rect class="building" x="800", y="270", width="240", height="90" onclick="showBuilding(event, '과학도서관')" />
                        <text x="900" y="320" class="building-label2">과학도서관</text>
                        <rect class="building" x="1145", y="180", width="90", height="200" onclick="showBuilding(event, '생명과학관')" />
                        <text x="1175" y="220" class="building-label2">생명</text>
                        <text x="1185" y="245" class="building-label2">과학관</text>
                        <rect class="building" x="1150", y="450", width="70", height="80" onclick="showBuilding(event, '정보전산처')" />
                        <text x="1180" y="490" class="building-label2">정보</text>
                        <text x="1185" y="515" class="building-label2">전산처</text>
                        <rect class="building" x="700", y="550", width="250", height="70" onclick="showBuilding(event, '제2공학관')" />
                        <text x="800" y="590" class="building-label2">제2공학관</text>
                        <rect class="building" x="1000", y="520", width="60", height="100" onclick="showBuilding(event, '이학관')" />
                        <text x="1030" y="570" class="building-label2">이학관</text>
                    </svg>

                    <!-- 세종공동캠퍼스 맵 (숨김) -->
                    <svg id="shared-map" viewBox="0 0 1200 700" class="map-image" style="display: none;">
                        <rect class="building" x="700" y="100" width="120" height="310" onclick="showBuilding(event, '세종공동실험실습관')" />
                        <rect class="building" x="200" y="500" width="200" height="100" onclick="showBuilding(event, '행정전문대학원관')" />
                        <rect class="building" x="100" y="330" width="150" height="70" onclick="showBuilding(event, '과학기술1관')" />
                    </svg>
                </div>
                <p>지도에서 건물을 선택하여 예약 가능 여부를 확인하세요.</p>
            </div>
        </div>
    </section>

    <footer>
        <p>© 2024 고려대학교 사이버보안학과 2024-2R 웹프로그래밍 무엇을도와드릴까요.</p>
    </footer>

    <script>
        document.addEventListener('DOMContentLoaded', function() {
            // 메뉴 사이드바 관련
            const menuBtn = document.querySelector('.menu-button');
            const closeMenuBtn = document.querySelector('.close-menu');
            const sideMenu = document.querySelector('.side-menu');
            
            // 건물 사이드바 관련
            const closeBuildingBtn = document.querySelector('.close-building-sidebar');
            const buildingSidebar = document.querySelector('.building-sidebar');

            menuBtn.addEventListener('click', () => {
                sideMenu.classList.add('active');
            });

            closeMenuBtn.addEventListener('click', () => {
                sideMenu.classList.remove('active');
            });

            closeBuildingBtn.addEventListener('click', () => {
                buildingSidebar.classList.remove('active');
            });

            // 메인 페이지 클릭 시 모든 사이드바 닫기
            const mainPage = document.querySelector('.main-page');
            mainPage.addEventListener('click', function(event) {
                sideMenu.classList.remove('active');
                buildingSidebar.classList.remove('active');
            });
        });

        function showBuilding(event, buildingName) {
            // 클릭 이벤트 전파 방지
            event.stopPropagation();
            console.log('Building clicked:', buildingName);
            
            // 요소 찾기
            const buildingSidebar = document.querySelector('.building-sidebar');
            const selectedBuildingName = document.getElementById('selected-building-name');
            
            if (!buildingSidebar) {
                console.error('Sidebar not found!');
                return;
            }
            
            if (!selectedBuildingName) {
                console.error('Building name element not found!');
                return;
            }

            // 건물 이름 설정 및 사이드바 활성화
            selectedBuildingName.textContent = buildingName;
            buildingSidebar.classList.add('active');
        }

        function handleSpaceReservation() {
            alert('공간 예약 페이지로 이동합니다.');
        }

        function handleSeatReservation() {
            alert('좌석 예약 페이지로 이동합니다.');
        }

        function switchCampus(campus) {
            document.getElementById('sejong-map').style.display = 'none';
            document.getElementById('seoul-map').style.display = 'none';
            document.getElementById('shared-map').style.display = 'none';
            
            document.getElementById(`${campus}-map`).style.display = 'block';
            
            document.querySelectorAll('.campus-btn').forEach(btn => {
                btn.classList.remove('active');
            });
            event.target.classList.add('active');
        }
    </script>
</body>
</html>
